## Step 1.2: Configure Design Tokens and Utility Functions

- **Task**: Create TypeScript design tokens for programmatic access and utility functions for styling.

- **Files**:

### `lib/design-tokens.ts`
```typescript
export const colors = {
  // Primary
  sage: {
    DEFAULT: '#8FA889',
    light: '#B8CCAE',
    pale: '#E8F0E5',
  },
  charcoal: '#2D3E4A',
  
  // Secondary
  teal: {
    DEFAULT: '#5F9EA0',
    focus: '#4A9B9B',
  },
  
  // Accents
  sand: '#D4C4B0',
  clay: '#C4A69D',
  
  // Functional
  success: '#5B8A72',
  warning: '#D4A574',
  error: '#C4706C',
  info: '#6A9CAE',
  
  // Backgrounds
  canvas: '#FAFAF8',
  surface: '#FFFFFF',
  elevated: '#F5F6F3',
  
  // Collection Tints
  grounding: '#F0F4EE',
  wholeness: '#F8F5F0',
  growth: '#F5F2EF',
  
  // Borders
  border: '#E8E9E6',
  borderStrong: '#D1D3CF',
  
  // Text
  text: {
    primary: '#2D3E4A',
    secondary: '#5A6B7A',
    tertiary: '#8A9BAA',
    inverse: '#FFFFFF',
  },
} as const;

export const typography = {
  fontFamily: {
    primary: "'Inter', system-ui, -apple-system, sans-serif",
    mono: "'JetBrains Mono', 'SF Mono', monospace",
  },
  fontSize: {
    'display-lg': { size: '36px', lineHeight: '44px', weight: 600 },
    'display': { size: '30px', lineHeight: '38px', weight: 600 },
    'h1': { size: '24px', lineHeight: '32px', weight: 600 },
    'h2': { size: '20px', lineHeight: '28px', weight: 600 },
    'h3': { size: '16px', lineHeight: '24px', weight: 600 },
    'h4': { size: '14px', lineHeight: '20px', weight: 600 },
    'body-lg': { size: '16px', lineHeight: '24px', weight: 400 },
    'body': { size: '14px', lineHeight: '20px', weight: 400 },
    'body-sm': { size: '13px', lineHeight: '18px', weight: 400 },
    'caption': { size: '12px', lineHeight: '16px', weight: 400 },
    'overline': { size: '11px', lineHeight: '16px', weight: 500, letterSpacing: '0.05em' },
    'metric': { size: '28px', lineHeight: '32px', weight: 600 },
  },
} as const;

export const spacing = {
  0: '0px',
  1: '4px',
  2: '8px',
  3: '12px',
  4: '16px',
  5: '20px',
  6: '24px',
  8: '32px',
  10: '40px',
  12: '48px',
  16: '64px',
} as const;

export const shadows = {
  'elevation-1': '0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.06)',
  'elevation-2': '0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.06)',
  'elevation-3': '0 10px 15px rgba(0,0,0,0.07), 0 4px 6px rgba(0,0,0,0.05)',
} as const;

export const radii = {
  sm: '4px',
  DEFAULT: '6px',
  md: '8px',
  lg: '12px',
  xl: '16px',
  full: '9999px',
} as const;

// Collection color mappings
export const collectionColors = {
  grounding: {
    bg: colors.grounding,
    accent: colors.sage.DEFAULT,
    text: colors.charcoal,
  },
  wholeness: {
    bg: colors.wholeness,
    accent: colors.sand,
    text: colors.charcoal,
  },
  growth: {
    bg: colors.growth,
    accent: colors.clay,
    text: colors.charcoal,
  },
} as const;

export type Collection = keyof typeof collectionColors;
```

### `lib/utils.ts`
```typescript
import { type ClassValue, clsx } from 'clsx';
import { twMerge } from 'tailwind-merge';

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}

export function formatCurrency(amount: number, currency = 'USD'): string {
  return new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency,
  }).format(amount);
}

export function formatNumber(num: number): string {
  if (num >= 1000000) {
    return (num / 1000000).toFixed(1) + 'M';
  }
  if (num >= 1000) {
    return (num / 1000).toFixed(1) + 'K';
  }
  return num.toString();
}

export function formatPercent(value: number, decimals = 1): string {
  return `${(value * 100).toFixed(decimals)}%`;
}

export function formatDate(date: Date | string, options?: Intl.DateTimeFormatOptions): string {
  const d = typeof date === 'string' ? new Date(date) : date;
  return new Intl.DateTimeFormat('en-US', {
    month: 'short',
    day: 'numeric',
    year: 'numeric',
    ...options,
  }).format(d);
}

export function formatTime(date: Date | string): string {
  const d = typeof date === 'string' ? new Date(date) : date;
  return new Intl.DateTimeFormat('en-US', {
    hour: 'numeric',
    minute: '2-digit',
    hour12: true,
  }).format(d);
}

export function formatDateTime(date: Date | string): string {
  return `${formatDate(date)} at ${formatTime(date)}`;
}

export function formatRelativeTime(date: Date | string): string {
  const d = typeof date === 'string' ? new Date(date) : date;
  const now = new Date();
  const diffMs = now.getTime() - d.getTime();
  const diffSecs = Math.floor(diffMs / 1000);
  const diffMins = Math.floor(diffSecs / 60);
  const diffHours = Math.floor(diffMins / 60);
  const diffDays = Math.floor(diffHours / 24);

  if (diffSecs < 60) return 'just now';
  if (diffMins < 60) return `${diffMins}m ago`;
  if (diffHours < 24) return `${diffHours}h ago`;
  if (diffDays < 7) return `${diffDays}d ago`;
  return formatDate(d);
}

export function truncate(str: string, maxLength: number): string {
  if (str.length <= maxLength) return str;
  return str.slice(0, maxLength - 3) + '...';
}

export function slugify(str: string): string {
  return str
    .toLowerCase()
    .replace(/[^\w\s-]/g, '')
    .replace(/[\s_-]+/g, '-')
    .replace(/^-+|-+$/g, '');
}

export function capitalize(str: string): string {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

export function sleep(ms: number): Promise<void> {
  return new Promise((resolve) => setTimeout(resolve, ms));
}

export function generateId(prefix = ''): string {
  const timestamp = Date.now().toString(36);
  const random = Math.random().toString(36).substring(2, 8);
  return prefix ? `${prefix}_${timestamp}${random}` : `${timestamp}${random}`;
}

export function debounce<T extends (...args: unknown[]) => unknown>(
  func: T,
  wait: number
): (...args: Parameters<T>) => void {
  let timeout: NodeJS.Timeout | null = null;
  
  return (...args: Parameters<T>) => {
    if (timeout) clearTimeout(timeout);
    timeout = setTimeout(() => func(...args), wait);
  };
}

export function throttle<T extends (...args: unknown[]) => unknown>(
  func: T,
  limit: number
): (...args: Parameters<T>) => void {
  let inThrottle = false;
  
  return (...args: Parameters<T>) => {
    if (!inThrottle) {
      func(...args);
      inThrottle = true;
      setTimeout(() => (inThrottle = false), limit);
    }
  };
}

export function groupBy<T, K extends string | number>(
  array: T[],
  keyFn: (item: T) => K
): Record<K, T[]> {
  return array.reduce(
    (acc, item) => {
      const key = keyFn(item);
      if (!acc[key]) acc[key] = [];
      acc[key].push(item);
      return acc;
    },
    {} as Record<K, T[]>
  );
}

export function sortBy<T>(
  array: T[],
  keyFn: (item: T) => string | number,
  order: 'asc' | 'desc' = 'asc'
): T[] {
  return [...array].sort((a, b) => {
    const aVal = keyFn(a);
    const bVal = keyFn(b);
    const comparison = aVal < bVal ? -1 : aVal > bVal ? 1 : 0;
    return order === 'asc' ? comparison : -comparison;
  });
}

export function pick<T extends object, K extends keyof T>(obj: T, keys: K[]): Pick<T, K> {
  return keys.reduce(
    (acc, key) => {
      if (key in obj) acc[key] = obj[key];
      return acc;
    },
    {} as Pick<T, K>
  );
}

export function omit<T extends object, K extends keyof T>(obj: T, keys: K[]): Omit<T, K> {
  const result = { ...obj };
  keys.forEach((key) => delete result[key]);
  return result;
}

export function isValidEmail(email: string): boolean {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(email);
}

export function isValidUrl(url: string): boolean {
  try {
    new URL(url);
    return true;
  } catch {
    return false;
  }
}
```

### `lib/constants.ts`
```typescript
// Collections
export const COLLECTIONS = ['grounding', 'wholeness', 'growth'] as const;
export type Collection = (typeof COLLECTIONS)[number];

// Moods (per spec Feature 7)
export const MOODS = ['calm', 'warm', 'hopeful', 'reflective', 'empowering'] as const;
export type Mood = (typeof MOODS)[number];

// Intensity levels
export const INTENSITY_LEVELS = [1, 2, 3, 4, 5] as const;
export type Intensity = (typeof INTENSITY_LEVELS)[number];

// Operator modes
export const OPERATOR_MODES = ['supervised', 'assisted', 'autopilot'] as const;
export type OperatorMode = (typeof OPERATOR_MODES)[number];

// Approval item types
export const APPROVAL_ITEM_TYPES = ['asset', 'mockup', 'pin', 'ugc', 'product'] as const;
export type ApprovalItemType = (typeof APPROVAL_ITEM_TYPES)[number];

// Approval statuses
export const APPROVAL_STATUSES = ['pending', 'approved', 'rejected', 'skipped', 'processing'] as const;
export type ApprovalStatus = (typeof APPROVAL_STATUSES)[number];

// Pin statuses
export const PIN_STATUSES = ['draft', 'scheduled', 'publishing', 'published', 'failed'] as const;
export type PinStatus = (typeof PIN_STATUSES)[number];

// Print sizes per spec Feature 7
export const PRINT_SIZES = {
  // 4:5 ratio
  '8x10': { width: 8, height: 10, ratio: '4:5', pixels: { width: 2400, height: 3000 } },
  '11x14': { width: 11, height: 14, ratio: '4:5', pixels: { width: 3300, height: 4200 } },
  '16x20': { width: 16, height: 20, ratio: '4:5', pixels: { width: 4800, height: 6000 } },
  // 3:4 ratio
  '12x16': { width: 12, height: 16, ratio: '3:4', pixels: { width: 3600, height: 4800 } },
  '18x24': { width: 18, height: 24, ratio: '3:4', pixels: { width: 5400, height: 7200 } },
  // 2:3 ratio
  '12x18': { width: 12, height: 18, ratio: '2:3', pixels: { width: 3600, height: 5400 } },
  '16x24': { width: 16, height: 24, ratio: '2:3', pixels: { width: 4800, height: 7200 } },
  '24x36': { width: 24, height: 36, ratio: '2:3', pixels: { width: 7200, height: 10800 } },
  // ISO sizes
  'A4': { width: 8.27, height: 11.69, ratio: '1:1.41', pixels: { width: 2480, height: 3508 } },
  'A3': { width: 11.69, height: 16.54, ratio: '1:1.41', pixels: { width: 3508, height: 4961 } },
} as const;

export type PrintSize = keyof typeof PRINT_SIZES;

// Social formats per spec Feature 7
export const SOCIAL_FORMATS = {
  pinterest: { width: 1000, height: 1500, ratio: '2:3', name: 'Pinterest Portrait' },
  instagram_post: { width: 1080, height: 1350, ratio: '4:5', name: 'Instagram Post' },
  instagram_story: { width: 1080, height: 1920, ratio: '9:16', name: 'Instagram Story' },
} as const;

export type SocialFormat = keyof typeof SOCIAL_FORMATS;

// Mockup scenes per spec Feature 10
export const MOCKUP_SCENES = [
  'bedroom',
  'therapy_office',
  'living_room',
  'reading_nook',
  'home_office',
] as const;

export type MockupScene = (typeof MOCKUP_SCENES)[number];

// Temporal tags per spec Feature 41
export const TEMPORAL_TAGS = {
  time_of_day: ['morning', 'afternoon', 'evening'],
  day_of_week: ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday', 'weekday', 'weekend'],
  seasonal: ['spring', 'summer', 'fall', 'winter'],
  special: [
    'new_year',
    'valentines',
    'mothers_day',
    'fathers_day',
    'thanksgiving',
    'christmas',
    'mental_health_awareness_month', // May
    'suicide_prevention_month', // September
    'self_care_september',
  ],
} as const;

// Guardrail defaults per spec Feature 1
export const GUARDRAIL_DEFAULTS = {
  daily_pin_limit: 5,
  weekly_ad_spend_cap: 100,
  monthly_ad_spend_cap: null,
  annual_mockup_budget: 3500,
  monthly_mockup_soft_limit: 292, // ~3500/12
  auto_retire_days: 7,
  abandonment_window_hours: 1,
  duplicate_content_days: 30,
} as const;

// Alert thresholds per spec Feature 22
export const ALERT_THRESHOLDS = {
  viral_impressions: 1000,
  high_performer_engagement: 0.08, // 8%
  underperformer_ctr: 0.02, // 2%
  conversion_winner_purchases: 5,
  underperformer_impressions_min: 500,
  underperformer_days_min: 14,
} as const;

// Email performance thresholds per spec Feature 32
export const EMAIL_THRESHOLDS = {
  low_open_rate: 0.20, // 20%
  low_click_rate: 0.02, // 2%
} as const;

// Discount codes per spec Feature 30
export const SEGMENT_DISCOUNT_CODES = {
  grounding: 'GROUNDED15',
  wholeness: 'WHOLE15',
  growth: 'GROW15',
} as const;

// Referral rewards per spec Feature 34
export const REFERRAL_REWARDS = {
  referrer_credit: 5, // $5
  referee_discount_percent: 15, // 15%
} as const;

// Lead nurturing timing per spec Feature 30
export const NURTURE_SEQUENCE_DAYS = [0, 2, 4, 7] as const;

// Post-purchase timing per spec Feature 31
export const POST_PURCHASE_TIMING = {
  confirmation: 0, // Hour 0
  printing_tips: 2, // Day 2
  photo_request: 7, // Day 7
  review_request: 14, // Day 14
  cross_sell: 30, // Day 30
} as const;

// VIP threshold per spec Feature 31
export const VIP_ORDER_THRESHOLD = 2;

// Win-back tiers per spec Feature 35
export const WINBACK_TIERS = {
  tier1: 60, // days
  tier2: 90,
  tier3: 120,
} as const;

// Quiz question count per spec Feature 25
export const QUIZ_QUESTION_COUNT = 7;
```

- **Step Dependencies**: Step 1.1
- **User Instructions**: None

---

