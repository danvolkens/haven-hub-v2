## Step 1.1: Initialize Next.js Project with Core Dependencies

- **Task**: Create the Next.js 14+ project with App Router, install all core dependencies, and configure TypeScript, Tailwind CSS, and ESLint. Set up the complete project structure.

- **Files**:

### `package.json`
```json
{
  "name": "haven-hub",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "type-check": "tsc --noEmit",
    "test": "vitest",
    "db:push": "npx supabase db push",
    "db:gen-types": "npx supabase gen types typescript --project-id $SUPABASE_PROJECT_ID > types/supabase.ts",
    "trigger:dev": "npx trigger.dev@latest dev"
  },
  "dependencies": {
    "next": "^14.2.0",
    "react": "^18.3.0",
    "react-dom": "^18.3.0",
    "@supabase/supabase-js": "^2.43.0",
    "@supabase/ssr": "^0.3.0",
    "@tanstack/react-query": "^5.45.0",
    "@tanstack/react-query-devtools": "^5.45.0",
    "zod": "^3.23.0",
    "date-fns": "^3.6.0",
    "date-fns-tz": "^3.1.0",
    
    "@dnd-kit/core": "^6.1.0",
    "@dnd-kit/sortable": "^8.0.0",
    "@dnd-kit/utilities": "^3.2.0",
    "react-hotkeys-hook": "^4.5.0",
    
    "recharts": "^2.12.0",
    "@fullcalendar/core": "^6.1.0",
    "@fullcalendar/react": "^6.1.0",
    "@fullcalendar/daygrid": "^6.1.0",
    "@fullcalendar/interaction": "^6.1.0",
    
    "lucide-react": "^0.378.0",
    "clsx": "^2.1.0",
    "tailwind-merge": "^2.3.0",
    "class-variance-authority": "^0.7.0",
    
    "@upstash/redis": "^1.31.0",
    "@upstash/ratelimit": "^1.2.0",
    
    "@aws-sdk/client-s3": "^3.577.0",
    "@aws-sdk/s3-request-presigner": "^3.577.0",
    
    "@trigger.dev/sdk": "^3.0.0",
    "@trigger.dev/nextjs": "^3.0.0",
    
    "@anthropic-ai/sdk": "^0.24.0",
    
    "sharp": "^0.33.0",
    "canvas": "^2.11.0",
    "archiver": "^7.0.0",
    
    "resend": "^3.2.0",
    "@react-email/components": "^0.0.19",
    
    "crypto-js": "^4.2.0",
    "nanoid": "^5.0.0"
  },
  "devDependencies": {
    "@types/node": "^20.12.0",
    "@types/react": "^18.3.0",
    "@types/react-dom": "^18.3.0",
    "@types/archiver": "^6.0.0",
    "typescript": "^5.4.0",
    "tailwindcss": "^3.4.0",
    "postcss": "^8.4.0",
    "autoprefixer": "^10.4.0",
    "eslint": "^8.57.0",
    "eslint-config-next": "^14.2.0",
    "@typescript-eslint/eslint-plugin": "^7.8.0",
    "@typescript-eslint/parser": "^7.8.0",
    "prettier": "^3.2.0",
    "prettier-plugin-tailwindcss": "^0.5.0",
    "vitest": "^1.6.0",
    "@testing-library/react": "^15.0.0"
  }
}
```

### `tsconfig.json`
```json
{
  "compilerOptions": {
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"],
      "@/components/*": ["./components/*"],
      "@/lib/*": ["./lib/*"],
      "@/hooks/*": ["./hooks/*"],
      "@/contexts/*": ["./contexts/*"],
      "@/types/*": ["./types/*"],
      "@/trigger/*": ["./trigger/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

### `tailwind.config.ts`
```typescript
import type { Config } from 'tailwindcss';

const config: Config = {
  content: [
    './pages/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
    './app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        // Primary
        sage: {
          DEFAULT: 'var(--color-sage)',
          light: 'var(--color-sage-light)',
          pale: 'var(--color-sage-pale)',
        },
        charcoal: 'var(--color-charcoal)',
        
        // Secondary
        teal: {
          DEFAULT: 'var(--color-teal)',
          focus: 'var(--color-focus-teal)',
        },
        
        // Accents
        sand: 'var(--color-warm-sand)',
        clay: 'var(--color-soft-clay)',
        
        // Functional
        success: 'var(--color-success)',
        warning: 'var(--color-warning)',
        error: 'var(--color-error)',
        info: 'var(--color-info)',
        
        // Backgrounds
        canvas: 'var(--color-canvas)',
        surface: 'var(--color-surface)',
        elevated: 'var(--color-elevated)',
        
        // Collection tints
        grounding: 'var(--color-grounding-tint)',
        wholeness: 'var(--color-wholeness-tint)',
        growth: 'var(--color-growth-tint)',
      },
      fontFamily: {
        primary: ['var(--font-primary)', 'system-ui', 'sans-serif'],
        mono: ['var(--font-mono)', 'monospace'],
      },
      fontSize: {
        'display-lg': ['36px', { lineHeight: '44px', fontWeight: '600' }],
        'display': ['30px', { lineHeight: '38px', fontWeight: '600' }],
        'h1': ['24px', { lineHeight: '32px', fontWeight: '600' }],
        'h2': ['20px', { lineHeight: '28px', fontWeight: '600' }],
        'h3': ['16px', { lineHeight: '24px', fontWeight: '600' }],
        'h4': ['14px', { lineHeight: '20px', fontWeight: '600' }],
        'body-lg': ['16px', { lineHeight: '24px' }],
        'body': ['14px', { lineHeight: '20px' }],
        'body-sm': ['13px', { lineHeight: '18px' }],
        'caption': ['12px', { lineHeight: '16px' }],
        'overline': ['11px', { lineHeight: '16px', fontWeight: '500', letterSpacing: '0.05em' }],
        'metric': ['28px', { lineHeight: '32px', fontWeight: '600' }],
      },
      spacing: {
        '18': '4.5rem',
        '88': '22rem',
        '128': '32rem',
      },
      boxShadow: {
        'elevation-1': '0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.06)',
        'elevation-2': '0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.06)',
        'elevation-3': '0 10px 15px rgba(0,0,0,0.07), 0 4px 6px rgba(0,0,0,0.05)',
      },
      borderRadius: {
        'sm': '4px',
        'DEFAULT': '6px',
        'md': '8px',
        'lg': '12px',
        'xl': '16px',
      },
      animation: {
        'fade-in': 'fadeIn 0.2s ease-out',
        'slide-up': 'slideUp 0.2s ease-out',
        'slide-down': 'slideDown 0.2s ease-out',
        'scale-in': 'scaleIn 0.15s ease-out',
      },
      keyframes: {
        fadeIn: {
          '0%': { opacity: '0' },
          '100%': { opacity: '1' },
        },
        slideUp: {
          '0%': { transform: 'translateY(10px)', opacity: '0' },
          '100%': { transform: 'translateY(0)', opacity: '1' },
        },
        slideDown: {
          '0%': { transform: 'translateY(-10px)', opacity: '0' },
          '100%': { transform: 'translateY(0)', opacity: '1' },
        },
        scaleIn: {
          '0%': { transform: 'scale(0.95)', opacity: '0' },
          '100%': { transform: 'scale(1)', opacity: '1' },
        },
      },
    },
  },
  plugins: [],
};

export default config;
```

### `next.config.js`
```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: '*.r2.cloudflarestorage.com',
      },
      {
        protocol: 'https',
        hostname: '*.cloudflare.com',
      },
      {
        protocol: 'https',
        hostname: 'dynamicmockups.com',
      },
      {
        protocol: 'https',
        hostname: '*.dynamicmockups.com',
      },
      {
        protocol: 'https',
        hostname: 'i.pinimg.com',
      },
    ],
  },
  experimental: {
    serverActions: {
      bodySizeLimit: '10mb',
    },
  },
  webpack: (config) => {
    // Required for canvas package
    config.externals = [...(config.externals || []), { canvas: 'canvas' }];
    return config;
  },
};

module.exports = nextConfig;
```

### `postcss.config.js`
```javascript
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};
```

### `.eslintrc.json`
```json
{
  "extends": [
    "next/core-web-vitals",
    "plugin:@typescript-eslint/recommended"
  ],
  "parser": "@typescript-eslint/parser",
  "plugins": ["@typescript-eslint"],
  "rules": {
    "@typescript-eslint/no-unused-vars": ["error", { "argsIgnorePattern": "^_" }],
    "@typescript-eslint/no-explicit-any": "warn",
    "prefer-const": "error",
    "no-console": ["warn", { "allow": ["warn", "error"] }]
  }
}
```

### `.prettierrc`
```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 100,
  "plugins": ["prettier-plugin-tailwindcss"]
}
```

### `.gitignore`
```
# Dependencies
node_modules
.pnp
.pnp.js

# Testing
coverage

# Next.js
.next/
out/

# Production
build

# Misc
.DS_Store
*.pem

# Debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Local env files
.env
.env*.local

# Vercel
.vercel

# TypeScript
*.tsbuildinfo
next-env.d.ts

# Supabase
supabase/.temp

# Trigger.dev
.trigger
```

### `app/layout.tsx`
```typescript
import type { Metadata } from 'next';
import { Inter, JetBrains_Mono } from 'next/font/google';
import './globals.css';

const inter = Inter({
  subsets: ['latin'],
  variable: '--font-primary',
  display: 'swap',
});

const jetbrainsMono = JetBrains_Mono({
  subsets: ['latin'],
  variable: '--font-mono',
  display: 'swap',
});

export const metadata: Metadata = {
  title: 'Haven Hub - Marketing Operations Platform',
  description: 'Comprehensive marketing operations platform for Haven & Hold',
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en" className={`${inter.variable} ${jetbrainsMono.variable}`}>
      <body className="bg-canvas text-charcoal font-primary antialiased">
        {children}
      </body>
    </html>
  );
}
```

### `app/page.tsx`
```typescript
import { redirect } from 'next/navigation';
import { createServerClient } from '@/lib/supabase/server';

export default async function HomePage() {
  const supabase = createServerClient();
  const { data: { session } } = await supabase.auth.getSession();

  if (session) {
    redirect('/dashboard');
  } else {
    redirect('/login');
  }
}
```

### `app/globals.css`
```css
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* Primary Colors */
  --color-sage: #8FA889;
  --color-charcoal: #2D3E4A;
  
  /* Secondary Colors */
  --color-teal: #5F9EA0;
  --color-sage-light: #B8CCAE;
  --color-sage-pale: #E8F0E5;
  
  /* Accent Colors */
  --color-warm-sand: #D4C4B0;
  --color-soft-clay: #C4A69D;
  --color-focus-teal: #4A9B9B;
  
  /* Functional Colors */
  --color-success: #5B8A72;
  --color-warning: #D4A574;
  --color-error: #C4706C;
  --color-info: #6A9CAE;
  
  /* Background Colors */
  --color-canvas: #FAFAF8;
  --color-surface: #FFFFFF;
  --color-elevated: #F5F6F3;
  
  /* Collection Tints */
  --color-grounding-tint: #F0F4EE;
  --color-wholeness-tint: #F8F5F0;
  --color-growth-tint: #F5F2EF;
  
  /* Border Colors */
  --color-border: #E8E9E6;
  --color-border-strong: #D1D3CF;
  
  /* Text Colors */
  --color-text-primary: #2D3E4A;
  --color-text-secondary: #5A6B7A;
  --color-text-tertiary: #8A9BAA;
  --color-text-inverse: #FFFFFF;
}

@layer base {
  * {
    @apply border-[var(--color-border)];
  }
  
  body {
    @apply text-body;
  }
  
  h1 {
    @apply text-h1;
  }
  
  h2 {
    @apply text-h2;
  }
  
  h3 {
    @apply text-h3;
  }
  
  h4 {
    @apply text-h4;
  }
}

@layer components {
  .btn {
    @apply inline-flex items-center justify-center rounded-md font-medium transition-colors
           focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-teal-focus focus-visible:ring-offset-2
           disabled:pointer-events-none disabled:opacity-50;
  }
  
  .btn-primary {
    @apply btn bg-sage text-white hover:bg-sage/90;
  }
  
  .btn-secondary {
    @apply btn border border-sage text-sage hover:bg-sage/10;
  }
  
  .btn-ghost {
    @apply btn text-charcoal hover:bg-elevated;
  }
  
  .btn-destructive {
    @apply btn bg-error text-white hover:bg-error/90;
  }
  
  .input {
    @apply flex h-10 w-full rounded-md border bg-surface px-3 py-2 text-body
           placeholder:text-[var(--color-text-tertiary)]
           focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-teal-focus
           disabled:cursor-not-allowed disabled:opacity-50;
  }
  
  .card {
    @apply rounded-lg border bg-surface shadow-elevation-1;
  }
  
  .card-elevated {
    @apply card shadow-elevation-2;
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
  
  .scrollbar-thin {
    scrollbar-width: thin;
    scrollbar-color: var(--color-border-strong) transparent;
  }
  
  .scrollbar-thin::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }
  
  .scrollbar-thin::-webkit-scrollbar-track {
    background: transparent;
  }
  
  .scrollbar-thin::-webkit-scrollbar-thumb {
    background-color: var(--color-border-strong);
    border-radius: 3px;
  }
}
```

### `.env.local.example`
```bash
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Shopify
SHOPIFY_CLIENT_ID=
SHOPIFY_CLIENT_SECRET=
SHOPIFY_WEBHOOK_SECRET=

# Pinterest
PINTEREST_CLIENT_ID=
PINTEREST_CLIENT_SECRET=

# Klaviyo
KLAVIYO_API_KEY=

# Dynamic Mockups
DYNAMIC_MOCKUPS_API_KEY=

# Resend
RESEND_API_KEY=

# Sky Pilot
SKY_PILOT_API_KEY=

# Claude/Anthropic
ANTHROPIC_API_KEY=

# Cloudflare R2
R2_ACCOUNT_ID=
R2_ACCESS_KEY_ID=
R2_SECRET_ACCESS_KEY=
R2_BUCKET_NAME=haven-hub-assets
R2_PUBLIC_URL=https://your-bucket.r2.cloudflarestorage.com

# Upstash Redis
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# Trigger.dev
TRIGGER_SECRET_KEY=

# Cron Secret (generate with: openssl rand -hex 32)
CRON_SECRET=
```

- **Step Dependencies**: None
- **User Instructions**: 
  1. Run `npm install`
  2. Copy `.env.local.example` to `.env.local`
  3. Create GitHub repository and push initial commit
  4. Connect to Vercel for deployments

---

